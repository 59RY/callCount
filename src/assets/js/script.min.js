/**
 * script.min.js
 * @version	1.0
 * @see		https://i.y59.jp/Johnny's/callCount/assets/js/script.js
 * @author	yuta*ﾟ {@link https://y59.jp/}
**/
function getCookie(e){var a=document.cookie,t="",r="",o="";return a.length>0?(t=a.indexOf(e+"="),-1!==t&&(t+=parseInt(e.length+1),r=a.indexOf(";",t),-1===r&&(r=a.length),o=unescape(a.substring(t,r)))):o="",o}function setCookie(e,a,t){var r=location.pathname,o=[];o=r.split("/"),""!==o[o.length-1]&&(o[o.length-1]="",r=o.join("/"));var n=(new Date).getTime(),l=new Date(n+864e5*t),c=l.toUTCString(),i="";i+=e+"="+escape(a),i+="; path="+r,i+=t?"; expires="+c+"; ":"; ",document.cookie=i}function insertComma(e){var a="";if("undefined"!=typeof e){for(e=String(e),e=halfWidthPlus(e),e=String(parseFloat(e));e!==(a=e.replace(/^([+-]?\d+)(\d\d\d)/,"$1,$2"));)e=a;return e}}function halfWidthPlus(e){return e.replace(/[Ａ-ｚ０-９]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)}).replace(/(,|，|､|、|\ |\　)/g,"").replace(/．/g,".").replace(/\‐\-\‑\—/g,"-")}function counterSet(e,a){var t,r=parseInt($("#callValue").attr("data-value"));return t=a?r+e:e,t>=0?(counterAffect(t),setCookie("callCount_value",t,731),t):void 0}function counterAffect(e){$("#callValue").attr("data-value",String(e)).html(insertComma(e));var a=$(".outWent");parseInt(e)>=1?a.show():a.hide()}function callArray_push(){callArray.push(String((new Date).getTime())),callArray_poped=!1,callArray_save()}function callArray_pop(){callArray_poped||(callArray.pop(),callArray_poped=!0,callArray_save())}function callArray_save(){var e=callArray.join(",");setCookie("callCount_array",e,731)}var callTo="0570000058",callArray=[],callArray_poped=!0;if("boolean"!=typeof twitter_for_iPhone)var twitter_for_iPhone=!1;var _ic=getCookie("callCount_array");""!==_ic&&"undefined"!=typeof _ic&&(callArray=_ic.split(",")),$(function(e){var a="ontouchend"in document,t=a?"touchstart":"mousedown",r=getCookie("callCount_value");""!==r&&"undefined"!=typeof r&&counterAffect(r),$(e).on(t,".callButton",function(){location.href="tel:"+callTo,counterSet(1,!0),callArray_push()}),$(e).on(t,".adjust",function(){var e=$(this).attr("data-count");switch(e){case"+1":counterSet(1,!0);break;case"-1":counterSet(-1,!0),callArray_pop();break;case"custom":var a=window.prompt("電話をかけた回数を半角で入力してください",parseInt($("#callValue").attr("data-value")));if("undefined"!=typeof a&&""!==a&&null!==a){a=halfWidthPlus(a);var t=parseInt(a);a===String(t)?a>=0?(counterSet(a,!1),setCookie("callCount_array","",-1)):alert("注：0 以上の数字を入力してください。"):alert("注：正しい数字を入力してください。")}break;case"reset":window.confirm("電話カウンターをリセットしてもよろしいですか?")&&(counterSet(0,!1),setCookie("callCount_array","",-1))}}),$(e).on(t,".outWent",function(){var e=!1;if(twitter_for_iPhone?e=!0:window.confirm("当落確認が出来ましたか?")&&(e=!0),e){var a=$(".notConnected"),t=$(".connected");a.addClass("fadeout"),setTimeout(function(){a.hide(),t.addClass("fadein")},500),setTimeout(function(){t.show()},1e3),$.ajax({type:"POST",url:"ajaxdata.php",data:{counter:$("#callValue").attr("data-value"),date_array:callArray,date_send:String((new Date).getTime())},timeout:10,dataType:"json",async:!1}),setCookie("callCount_value","0",-1),setCookie("callCount_array","",-1),callArray=[]}}),$(e).on(t,".share",function(){var e=$(this).attr("data-shareto"),a=$("#callValue").attr("data-value"),t=location.href,r=encodeURI("ジャニーズ当落電話カウンター! 私は"+insertComma(a)+"回で繋がりました٩(๑^o^๑)۶"),o=encodeURI("当落電話カウンター"),n="";switch(e){case"twitter":n="https://twitter.com/share?via=y59JP&text="+r+"&url="+t+"&hashtags="+o+"&lang=ja";break;case"facebook":n="https://www.facebook.com/sharer.php?u="+t;break;case"line":n="line://msg/text/"+r+"%0D%0A"+encodeURI(t)}""!==n&&(twitter_for_iPhone?location.href=n:window.open(n,"_blank"))})}($(document)));
